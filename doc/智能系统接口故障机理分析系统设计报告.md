# 智能系统接口故障机理分析系统设计报告

## 1 系统概述

### 1.1 任务目的
智能系统接口故障机理分析系统用于支撑复杂装备和自主系统在方案论证、初样设计阶段的可靠性验证工作，核心目标是统一表达接口、模块与系统结构的功能行为数据，并在建模层面链接任务剖面、环境应力与分析算法。现有原型基于 PyQt5 桌面框架构建，提供跨模块的项目管理、仿真与可视化能力，使工程师能够在设计阶段识别接口耦合、状态转移与任务策略中的潜在故障模式，形成可追溯的分析链路。【F:src/ui/main_window.py†L48-L148】【F:src/core/project_manager.py†L23-L83】

界面框架通过主窗口统一调度系统画布、模块面板、接口面板、任务剖面、环境建模与故障树分析六个标签页，工程师可以在单一上下文内完成模型构建、仿真计算与结果研判。系统画布负责模块拓扑编辑，接口面板承担失效模式与状态机制定，任务与环境模块收集分析参数，而故障树面板将计算结果转化为图形化知识结构，确保分析过程具有闭环反馈。【F:src/ui/main_window.py†L79-L148】【F:src/ui/system_canvas.py†L166-L199】【F:src/ui/interface_panel.py†L22-L190】

与传统静态文档式分析相比，该原型强调模型驱动的持续迭代：工程师在项目管理器中维护系统版本，必要时通过模块脚本模拟接口响应，再结合环境应力与任务判据生成新的故障树与可靠度曲线，以支撑方案优化和快速验证。【F:src/core/project_manager.py†L28-L92】【F:src/models/module_model.py†L162-L200】【F:src/core/fault_tree_generator.py†L31-L120】

### 1.2 设计依据
设计方案遵循原型仓库的软件设计说明与需求规格，通过界面层、业务层、数据层的分层结构重用既有实现，并结合可靠性研究中的建模范式。软件设计说明中给出的模块划分、数据模型与故障树算法，是本文档描述的实现基础。【F:doc/软件设计说明.md†L56-L197】同时，报告参考无人机飞控系统可靠性分析的 SysML 建模与蒙特卡洛仿真研究，总结其在功能行为建模、动态故障树生成与统计推断方面的经验，用于指导接口故障机理的理论框架。【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L632-L770】

在实现层面，项目遵循需求规格对接口建模、模块建模、系统结构、任务剖面、环境建模与故障树分析的流程约束，强调模板复用、版本控制、脚本校验与数据一致性。界面组件与业务逻辑之间通过项目树、标签页和停靠面板完成信息同步，保证在画布上调整拓扑或在表单里更新判据时，底层 `SystemStructure` 与持久化文件保持一致。【F:doc/软件需求规格.md†L73-L226】【F:src/ui/main_window.py†L79-L148】【F:src/models/system_model.py†L299-L420】

此外，系统的算法与仿真约定与文献中的可靠性分析步骤保持一致：接口状态机与失效模式抽象借鉴最小割集推导过程，环境应力与失效率的映射参考阿伦尼乌斯模型近似，而蒙特卡洛统计评估沿用了指数分布假设与置信区间推断，使软件实现与理论分析互为验证。【F:src/core/fault_tree_generator.py†L195-L259】【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L621-L756】

## 2 任务要求
系统需覆盖模型构建、任务与环境建模、故障分析三个方面的主流程：
1. 在统一项目内管理接口模板、模块实例、系统连接，并保证模型间的引用一致性与版本化控制。【F:src/models/system_model.py†L302-L420】
2. 支持任务剖面阶段、成功判据及结果的配置，结合环境应力模型定义仿真条件，为故障树与蒙特卡洛分析提供参数入口。【F:doc/软件需求规格.md†L154-L200】【F:src/models/system_model.py†L109-L212】
3. 自动生成故障树、执行定性与定量分析，并以图形化方式呈现关键事件、概率指标、敏感度报告，满足安全验证流程的可视化要求。【F:doc/软件需求规格.md†L201-L226】【F:src/core/fault_tree_generator.py†L31-L304】

上述能力需要在桌面端应用中集成，要求界面交互、项目持久化、脚本沙箱执行与日志追踪协同运行。【F:main.py†L22-L38】【F:src/core/project_manager.py†L35-L99】

系统还需满足多角色协作和可追溯性约束：主窗口在项目树中展示模块、接口、任务、环境与故障树资源，确保工程师与可靠性分析师能够共享同一项目上下文；保存、另存及加载流程为版本审计提供基础，未保存变更通过状态栏提醒用户，避免模型不一致。【F:src/ui/main_window.py†L99-L195】【F:src/core/project_manager.py†L35-L92】

非功能性需求主要集中在沙箱执行、安全控制与性能可控。模块与接口脚本在受限执行环境中运行，输出字典化数据，以便仿真循环累积系统状态；蒙特卡洛分析与故障树生成保持可配置迭代次数和深度上限，防止桌面环境资源耗尽；界面交互采用分区布局与懒加载树节点，提升在大型模型下的响应性。【F:src/models/module_model.py†L162-L200】【F:src/core/fault_tree_generator.py†L23-L63】【F:src/ui/interface_panel.py†L62-L118】

## 3 理论与方法

### 3.1 基于功能行为的接口、模块、系统建模方法
原型系统采用功能-行为-结构（FBS）思想，将接口、模块、系统三个粒度的模型统一在 `SystemStructure` 对象中。接口模型记录类型、方向、参数、脚本与状态机描述，对应功能视角下的数据或控制交互约束；模块模型聚合接口集合、参数、状态变量与行为脚本，描述单元内部逻辑及冗余策略；系统模型则维护模块、接口、连接、任务与环境的图结构，体现物理结构与功能流程映射。【F:src/models/interface_model.py†L403-L782】【F:src/models/module_model.py†L56-L214】【F:src/models/system_model.py†L299-L420】

在建模过程中，接口与模块模板可用于复用典型结构，保持功能定义的稳定性。模板包含完整的状态机、失效模式与触发条件，实例化时克隆脚本与参数，实现行为层的可继承性，同时允许在实例上进一步细化。【F:src/models/interface_model.py†L697-L751】【F:src/models/module_model.py†L188-L246】这类实现对应研究中强调的“自模型表达”方法：通过模型直接保存行为脚本与约束，可在仿真过程中动态调用，避免把行为逻辑散布在代码中。【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L632-L704】系统模型提供 `simulate_system` 方法顺序执行模块脚本并叠加环境应力，实现功能行为到仿真行为的闭环。【F:src/models/system_model.py†L393-L409】

模型层的基类统一提供 ID、名称、修改时间与序列化接口，使得接口、模块、任务与环境实体都具备一致的生命周期管理。界面层在加载项目时通过 `from_dict` 恢复对象，再将其映射到画布与表单控件，实现模型与可视化的同步；保存项目时，`to_dict` 将嵌套对象转化为 JSON，确保模板、脚本、状态历史等信息完整保留，支撑跨团队共享与知识积累。【F:src/models/system_model.py†L156-L212】【F:src/models/module_model.py†L183-L220】【F:src/models/interface_model.py†L165-L214】

### 3.2 接口、模块的工作状态转换机制
接口对象内置状态机，默认含有正常状态，用户可添加多个故障状态，并通过 `InterfaceTransition` 关联触发条件。状态机执行时按照优先级评估转换条件，若满足则迁移到目标状态，并记录历史事件，为后续故障树抽取与任务日志提供依据。【F:src/models/interface_model.py†L448-L627】触发条件支持阈值、事件、时间与概率等类型，且可嵌入脚本处理复杂情况，例如结合环境传感值与任务阶段变量进行判定。【F:src/models/interface_model.py†L58-L163】

模块级状态管理通过状态变量与脚本实现，冗余逻辑或备份模式可以在脚本中访问接口状态、环境参数并调整输出。系统模型在仿真中遍历模块，调用 `execute_python_code`，并将接口状态结果汇入共享状态字典，使模块状态变更与接口状态同步演化。【F:src/models/module_model.py†L162-L181】【F:src/models/system_model.py†L400-L409】这种机制与研究中提出的“状态机-功能映射”一致：先基于最小割集构建状态机，再与接口结构联动，确保故障行为可模拟。【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L621-L636】

接口对象会维护有限长度的状态历史，记录每次转换的时间戳、源状态与目标状态，便于追溯触发条件与任务阶段之间的关联；历史长度可配置，既避免日志无限增长，又保留用于事故复盘的关键信息。触发条件在执行脚本或阈值判断失败时不会破坏状态机，而是返回默认状态，从而保障模型计算的稳定性。模块脚本若出现异常亦会捕获并记录提示，仿真循环继续推进，体现“容错仿真”的设计理念。【F:src/models/interface_model.py†L16-L163】【F:src/models/interface_model.py†L531-L583】【F:src/models/module_model.py†L175-L181】

### 3.3 任务剖面的描述方法
任务剖面采用阶段化描述，每个 `TaskProfile` 记录持续时间、优先级、初始条件及成功判据集合，支持多个剖面共存并切换分析对象。成功判据可指向特定模块输出，选择阈值、范围、布尔判断或脚本形式，执行时从系统状态中读取数据进行判定。【F:src/models/system_model.py†L31-L120】需求规格文档要求任务剖面支持阶段列表、判据关联、结果保存与版本管理，确保仿真与故障树分析可追溯。【F:doc/软件需求规格.md†L154-L176】

剖面与系统模型的关联体现在 `SystemStructure` 记录当前选用的剖面 ID，并在故障树生成器中将成功判据映射为顶事件下的关键路径。蒙特卡洛仿真从剖面读取持续时间与任务约束，形成仿真时间窗与输出指标集合，与研究中强调的“任务约束驱动仿真”一致。【F:src/models/system_model.py†L368-L409】【F:src/core/fault_tree_generator.py†L84-L176】【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L704-L738】

任务剖面面板提供判据编辑对话框、阶段表格与版本化管理，使分析人员能够配置阈值型、范围型、布尔型及自定义脚本判据，并绑定模块输出或系统变量。界面层在保存剖面时会触发项目管理器标记修改，保证任务配置的变动纳入项目版本；评估环节再调用模型的 `evaluate_task_success` 生成成功率与任务状态，为故障树顶事件设定概率基础。【F:src/ui/task_profile_panel.py†L22-L200】【F:src/models/system_model.py†L109-L155】

### 3.4 环境应力的数学模型与作用原理
环境模块由 `EnvironmentModule` 与 `StressFactor` 组成。应力因子定义分布、时间剖面、作用范围及可选的自定义代码，支持温度、振动、电磁、网络延迟等多类型负荷，并允许设置持续时间与启停条件。【F:src/models/environment_model.py†L13-L207】在仿真过程中，环境模块针对受影响模块写入温度、振动、延迟等状态项，并可通过脚本实现复杂耦合，例如根据多个应力的联合分布调整输出。【F:src/models/environment_model.py†L161-L207】

需求规格对环境子系统提出了应力参数校验、故障注入与概率触发的业务流程，强调环境建模需要与任务剖面、仿真算法共享数据。【F:doc/软件需求规格.md†L177-L200】在理论层面，可借鉴可靠性研究中对环境应力与失效率关系的建模方法，例如针对温度采用阿伦尼乌斯模型近似，将温度差映射为失效率倍增系数，该思想已在故障树生成器中用于估计环境事件概率。【F:src/core/fault_tree_generator.py†L241-L259】

环境建模面板为每个应力因子提供分布、时间剖面与自定义脚本配置，允许设定基准值、变化范围、启停时刻，并通过列表选择受影响模块。界面在保存配置时同步更新 `EnvironmentModule` 对象，后者再通过 `apply_environment_stress` 方法在仿真循环中写入状态变量，实现环境应力、模块状态与任务判据之间的闭环数据流。【F:src/ui/environment_panel.py†L22-L172】【F:src/models/environment_model.py†L128-L207】

### 3.5 蒙特卡洛模拟计算原理与方法
系统的蒙特卡洛分析遵循“样本生成—状态演化—事件统计—指标估计”的通用流程。研究文献指出，应先结合故障树最小割集建立顶事件失效数学模型，再基于指数分布等假设生成随机样本，通过多次迭代逼近可靠性指标，并根据伯努利定理、大数定律与中心极限定理分析收敛性。【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L632-L760】原型系统在仿真函数中遍历模块脚本、应用环境应力，得到每次迭代的系统状态；通过成功判据判断任务是否成功，并在故障树分析模块中更新事件概率或导出统计报告。【F:src/models/system_model.py†L393-L409】【F:src/core/fault_tree_generator.py†L290-L303】

实现层面，可在仿真配置中设定样本数量、任务时间范围、应力分布，并在每轮模拟后记录底事件触发情况，计算任务成功率、平均无故障时间与置信区间。论文中的实践显示，仿真次数提升至 10000 次后 MTBF 收敛，与理论值误差约 0.00123%，为配置样本量提供参考标准。【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L747-L760】

系统在执行蒙特卡洛分析时，先由 `SystemStructure` 根据任务剖面初始化模块状态，再在每个样本内依次运行模块脚本、环境应力和接口状态机。故障树生成器会在 `_set_event_probabilities` 阶段读取统计结果，将底事件失效率转换为概率或保持默认值，顶事件再通过逻辑门组合得到可靠度指标，支持配置最大深度、最小概率阈值以控制计算规模。【F:src/models/system_model.py†L337-L409】【F:src/core/fault_tree_generator.py†L23-L120】【F:src/core/fault_tree_generator.py†L195-L259】

### 3.6 故障树自动生成方法
故障树生成器以任务剖面和系统结构为输入，先构造顶事件，再根据成功判据或模块列表递归分解，自动创建逻辑门和中间事件。接口失效、模块内部失效与环境因素分别映射为基本事件，通过配置选项决定是否纳入树结构。【F:src/core/fault_tree_generator.py†L31-L222】算法依赖系统模型中的接口、连接、环境关系，获取失效模式、失效率及应力放大因子，并创建对应事件节点和 OR 门。生成后执行简单布局计算，为界面展示提供坐标信息。【F:src/core/fault_tree_generator.py†L175-L363】

研究文献提出基于 SysML 模型的动态故障树生成方法，通过语义映射自动提取事件与逻辑门，并结合最小割集构建状态机。该思想与原型中利用模板与依赖关系构建故障树的流程一致，为后续扩展动态逻辑门、冗余策略和时序约束提供理论依据。【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L621-L704】

界面层在故障树面板内通过独立线程执行生成任务，实时更新进度条并在完成后绘制事件、逻辑门及概率标注；同时支持最小割集与重要度指标的计算与展示，使用户能够从结构与数值两个角度审视任务风险。图形视图按照布局结果渲染节点与连线，提供橡皮筋选择与自适应视图功能，方便对大规模故障树进行浏览与分析。【F:src/ui/fault_tree_panel.py†L25-L156】【F:src/core/fault_tree_generator.py†L56-L193】

### 3.7 基于故障树的任务可靠性分析方法
故障树生成后，可进行定性与定量分析。定性方面，系统通过逻辑门结构识别导致顶事件的关键路径，可扩展最小割集计算与敏感度排序，用于定位关键接口或模块。定量方面，底事件概率可来源于失效率估算、蒙特卡洛仿真结果或专家评估，系统根据任务持续时间计算顶事件概率，并输出可靠度、失效率等指标。【F:src/core/fault_tree_generator.py†L195-L303】

论文中的分析步骤包括：基于仿真结果统计各底事件的触发次数，计算顶事件失效概率与可靠度曲线；在多次仿真后评估置信区间，为可靠性约束提供依据。【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L704-L745】将这些方法与系统实现结合，可在故障树面板中呈现任务阶段映射、事件重要度与可靠度趋势，为任务规划与冗余优化提供量化支撑。

故障树数据模型维护事件与逻辑门的概率、失效率、不可用度及重要度指标，支持根据任务时间计算指数分布概率，或在存在修复率时评估稳态不可用度。逻辑门实现与、或、异或、表决等组合逻辑，为未来扩展优先与门、禁门提供结构基础；在最小割集求解与重要度评估后，可将结果回写到任务剖面和报告模块，形成“模型—分析—决策”的闭环。【F:src/models/fault_tree_model.py†L38-L210】【F:src/ui/fault_tree_panel.py†L25-L156】

## 4 设计方案

### 4.1 整体框架
系统采用三层架构：表示层由主窗口、系统画布及功能面板构成，负责模型编辑、参数输入与结果展示；业务层由 `ProjectManager`、`FaultTreeGenerator` 等服务类组成，处理项目生命周期、仿真调度与分析逻辑；数据层由 `SystemStructure` 及相关模型承担序列化、状态管理与脚本执行职责。【F:src/ui/main_window.py†L31-L148】【F:src/core/project_manager.py†L23-L99】【F:src/models/system_model.py†L299-L409】各层之间通过对象引用与事件信号交互，形成清晰的数据流和控制流。

主窗口使用项目树与标签页驱动导航，用户在画布上创建模块或在面板中编辑任务剖面时，`ProjectManager` 会被标记为已修改；保存操作则触发 `SystemStructure.to_dict`，将模块、接口、环境、任务与故障树配置一并写入 JSON 文件。加载项目后，界面层根据模型数据重建画布布局、列表树节点与表单内容，实现模型与可视化的同步恢复。【F:src/ui/main_window.py†L99-L188】【F:src/core/project_manager.py†L35-L83】【F:src/models/system_model.py†L297-L420】

### 4.2 接口建模模块

#### 4.2.1 功能要求
接口模块需要提供接口模板管理、实例编辑、状态机配置与失效模式维护，同时支持脚本沙箱、触发条件配置、模板复用与版本化，满足需求规格提出的创建、编辑、状态机定义、代码校验、模板发布等操作。【F:doc/软件需求规格.md†L73-L99】界面层应提供列表与表单，允许批量添加失效模式、导入导出接口定义，并与系统结构保持同步。

接口面板以分类树展示模板与实例，配合详情表单、失效模式列表、触发条件编辑器以及脚本输入区域，实现从属性配置到行为脚本的一体化管理。用户在界面中新增或复制接口后，系统自动为失效模式生成状态与转换骨架，避免手工同步结构；保存动作会通过项目管理器更新 `SystemStructure.interfaces`，确保模型与视图一致。【F:src/ui/interface_panel.py†L22-L190】【F:src/models/interface_model.py†L403-L627】

#### 4.2.2 模块接口
模块接收来自模块建模或系统结构模块的接口模板或实例化请求，输出接口对象、状态机与失效模式集合供其他模块调用。对外公开的核心方法包括新增/删除接口、克隆模板、执行状态机一步、序列化与反序列化等。【F:src/models/interface_model.py†L403-L839】模块还需提供事件日志与状态查询接口，以支持故障树分析与仿真。

#### 4.2.3 模块总体设计与结构
接口建模模块由接口管理器、失效模式库、状态机引擎三部分组成。接口管理器维护接口集合与模板映射，负责与项目管理器交换数据；失效模式库封装触发条件、影响描述与缓解措施；状态机引擎提供状态与转换管理、历史记录与输出计算。内部采用观察者模式，在接口变更时通知系统结构与模块建模模块更新引用。【F:src/models/interface_model.py†L424-L639】【F:src/models/system_model.py†L335-L344】

状态机引擎在执行过程中会收集输入、状态变量、环境数据及随机数，逐一评估触发条件，并在转移成功后记录历史事件与时间戳；若多个转换满足条件，则依照优先级排序执行，保证紧急失效优先响应。失效模式可附加脚本用于计算失效率、输出恢复措施或更新接口参数，使接口行为具备可扩展的定量分析能力。【F:src/models/interface_model.py†L448-L627】【F:src/models/interface_model.py†L200-L330】

#### 4.2.4 模块详细设计
接口对象持有参数字典、脚本、状态机与失效模式列表。`add_failure_mode` 会自动为失效模式创建对应的故障状态与转换；`step_state_machine` 在执行时构造上下文，包括输入、状态变量、环境参数与随机数，用于评估触发条件并执行状态代码。【F:src/models/interface_model.py†L531-L627】序列化方法将接口属性、状态机结构、失效模式与历史记录写入字典，支持项目文件保存与模板复用。【F:src/models/interface_model.py†L756-L839】

### 4.3 模块建模模块

#### 4.3.1 功能要求
模块建模模块需支持硬件、软件、算法等类型模板的创建、接口关联、参数与状态变量配置、行为脚本编辑、冗余策略描述以及实例化管理，与需求规格中的功能列表保持一致。【F:doc/软件需求规格.md†L100-L126】同时要兼容旧版连接点数据，保证历史项目可迁移。

模块面板通过模块列表、模板库与多标签页编辑器组织交互，支持从模板快速实例化模块、配置接口和参数，并提供专用属性页区分硬件、软件、算法模块的特性字段。界面在保存时将模块写回 `SystemStructure.modules` 并标记项目变更，形成从图形化操作到数据模型的同步链路。【F:src/ui/module_panel.py†L24-L156】【F:src/models/system_model.py†L297-L356】

#### 4.3.2 模块接口
对外接口包括添加、移除、查询模块，关联接口与连接点，执行脚本，序列化与反序列化。`execute_python_code` 提供沙箱执行环境，允许读取输入、参数、状态变量并输出结果；`add_connection_point` 支持把旧版连接点转换为接口对象，确保模型结构统一。【F:src/models/module_model.py†L70-L137】

#### 4.3.3 模块总体设计与结构
模块对象包含模块类型、模板枚举、几何信息、接口字典、参数、状态变量与脚本。继承体系区分硬件、软件、算法模块，分别扩展制造商、版本、依赖、性能指标等属性，用于在界面展示与分析报告中提供细分信息。【F:src/models/module_model.py†L253-L352】模块建模模块与系统结构模块共享模块实例，并通过项目管理器统一保存。

#### 4.3.4 模块详细设计
`Module.to_dict` 序列化时保存接口集合、参数、脚本与几何信息；`from_dict` 则根据 `module_type` 与模板枚举重建对象，并加载接口定义。硬件模块附加可靠性数据字段，可用作失效率估计输入；软件模块记录编程语言、依赖、性能指标，便于评估资源需求；算法模块保留模型参数、训练数据描述，为任务剖面配置提供参考。【F:src/models/module_model.py†L183-L352】

### 4.4 系统结构建模模块

#### 4.4.1 功能要求
系统结构模块提供图形化画布、模块拖拽、接口连线、参数配置、拓扑校验与版本管理，满足需求规格中画布管理、连线配置、校验与发布等要求。【F:doc/软件需求规格.md†L127-L152】同时需要支持视图缩放、分层显示、撤销重做与差异比较。

系统画布借助 `QGraphicsView` 与自定义图元实现模块拖拽、接口对接、连线绘制及属性编辑，支持橡皮筋选择、悬停高亮与双击事件，方便在复杂拓扑下快速定位元素。每个模块图元携带类型、尺寸与位置属性，接口图元根据方向自动着色，连线通过控制点调整路由，为后续布局优化提供基础。【F:src/ui/system_canvas.py†L112-L199】

#### 4.4.2 模块接口
核心方法包括添加/删除模块、接口、连接，设置画布尺寸、缩放比例、视图偏移，获取当前任务剖面等。模块向项目管理器提供序列化结构，用于保存与加载项目；向界面层提供模块列表与连线集合，用于绘制图形。【F:src/models/system_model.py†L314-L420】

#### 4.4.3 模块总体设计与结构
系统结构以图模型表示，节点为模块，边为连接，属性包含接口方向、数据格式、约束条件。模块删除时自动移除相关连线，保持引用一致性；加载项目时根据模块类型实例化具体类，确保行为与属性正确恢复。【F:src/models/system_model.py†L319-L396】校验器可扩展连通性、冗余一致性与任务约束检查，为发布前审查提供依据。

#### 4.4.4 模块详细设计
`SystemStructure` 维护画布大小、缩放、偏移等视图信息，支持在界面恢复用户布局。`simulate_system` 方法整合模块执行与环境应力施加，为故障树与蒙特卡洛提供统一仿真入口；未来可在此处增加事件调度与时间步长管理，以支持离散事件仿真或混合动力学模型。【F:src/models/system_model.py†L393-L409】

### 4.5 任务剖面编辑模块

#### 4.5.1 功能要求
任务模块负责剖面管理、阶段配置、判据关联与结果保存，提供多剖面切换、版本记录、数据校验等功能，对应需求规格中的剖面管理流程。【F:doc/软件需求规格.md†L164-L175】

#### 4.5.2 模块接口
模块提供创建、复制、删除剖面，添加阶段、成功判据，设置初始条件、环境条件与期望输出，并与故障树、蒙特卡洛模块共享剖面数据。`TaskProfile.add_success_criteria`、`evaluate` 等方法在仿真或分析中使用，判断任务是否满足成功条件。【F:src/models/system_model.py†L123-L170】

#### 4.5.3 模块总体设计与结构
任务剖面模块采用表格化管理，阶段与判据对象保存在列表中，可通过 ID 与系统结构关联模块输出。分析完成后结果写入 `fault_tree_analysis_results` 字段，便于回溯历史记录与报告生成。剖面对象在 `SystemStructure` 中注册，支持切换当前剖面并自动保存选择。【F:src/models/system_model.py†L368-L388】

#### 4.5.4 模块详细设计
`SuccessCriteria.evaluate` 根据模块 ID 与参数名从系统状态读取值，支持阈值比较或脚本执行，脚本环境提供系统状态、参数、阈值等上下文变量，方便实现复杂判据。【F:src/models/system_model.py†L45-L106】任务模块需与界面层配合，实现阶段时间校验、判据引用验证与差异比较，确保剖面数据一致性。

### 4.6 环境建模模块

#### 4.6.1 功能要求
环境模块需支持环境模板、应力因子、作用对象与脚本配置，满足需求规格中对应的参数校验、故障注入、概率触发与仿真调度能力。【F:doc/软件需求规格.md†L177-L199】

环境面板提供应力因子列表、参数表单与时间剖面配置器，允许通过对话框编辑分布类型、基准值、变化范围与启停时间，并在界面中直观展示受影响模块集合。自定义脚本编辑区帮助分析人员定义复杂耦合或外部数据驱动的应力变化，形成可复用的环境模板库。【F:src/ui/environment_panel.py†L22-L172】

#### 4.6.2 模块接口
主要接口包括添加/删除应力因子、设置作用模块、生成应力样本、执行环境脚本、序列化/反序列化。`apply_environment_stress` 返回施加应力后的系统状态，在仿真循环中被调用；`generate_stress_value` 根据分布与时间剖面计算应力值，可扩展为支持联合分布或外部数据驱动。【F:src/models/environment_model.py†L45-L205】

#### 4.6.3 模块总体设计与结构
环境模块由应力管理器、分布库、耦合解析器组成。应力管理器维护因子列表及启用状态；分布库实现正态、均匀、指数等采样；耦合解析器可扩展多应力相关性描述，通过脚本实现复杂关系。环境模块与系统结构共享受影响模块列表，在故障树分析时将应力因子转换为环境相关事件。【F:src/models/environment_model.py†L128-L207】【F:src/core/fault_tree_generator.py†L224-L259】

#### 4.6.4 模块详细设计
序列化时保存环境类型、参数、应力因子列表、位置与图标等属性，确保界面重载时恢复布局。执行脚本时提供系统状态、当前时间、参数与应力样本，可用于实现任务阶段依赖的环境变化或数据驱动的应力曲线。【F:src/models/environment_model.py†L191-L207】

### 4.7 故障树分析模块

#### 4.7.1 功能要求
故障树模块需自动生成树结构、支持编辑与导出，并提供定性分析（最小割集、路径重要度）、定量分析（概率、敏感度）与报告输出功能，对应需求规格中的生成、展示、分析、导出要求。【F:doc/软件需求规格.md†L201-L220】界面需呈现图形化树结构、事件属性与分析结果。

#### 4.7.2 模块接口
核心接口包括 `generate_fault_tree`、`_generate_fault_tree_structure`、`_set_event_probabilities`、`_layout_fault_tree` 等，输入系统模型与任务剖面，输出 `FaultTree` 对象，包含事件、逻辑门、概率、布局信息。接口还允许配置是否包含接口失效、模块失效、环境影响以及深度限制等参数。【F:src/core/fault_tree_generator.py†L31-L363】

#### 4.7.3 模块总体设计与结构
故障树模块由树生成器、概率引擎、布局器、报告器组成。树生成器负责解析模型、创建事件与逻辑门；概率引擎根据失效率或仿真数据计算事件概率；布局器采用层次化算法设置节点坐标；报告器可扩展生成 PDF/HTML 等格式的分析报告。环境事件在生成时会根据应力因子参数估算失效率，体现环境与故障之间的耦合。【F:src/core/fault_tree_generator.py†L195-L363】

#### 4.7.4 模块详细设计
生成流程首先创建顶事件并设置任务时长，再解析成功判据或模块列表分解中间事件，随后遍历模块连接与失效模式创建底事件。概率计算阶段遍历所有基本事件，若配置了失效率则根据任务时长转换为失效概率；否则使用默认概率或仿真统计值。布局算法按照广度优先搜索计算层级，确保图形化展示清晰。【F:src/core/fault_tree_generator.py†L66-L390】

## 注释
- “模块”指系统结构中可被实例化的实体，可能代表硬件、软件或算法组件，其行为通过 Python 脚本或参数配置描述。
- “脚本”指内嵌在模型中的 Python 代码，用于定义接口、模块或环境的行为逻辑，执行时在受控沙箱内运行，禁止访问危险操作。【F:src/models/module_model.py†L162-L181】【F:src/models/environment_model.py†L191-L207】
- 研究文献提供的建模与分析方法源于无人机飞控系统案例，在当前系统中可作为理论指导，具体参数与结构需根据目标装备特性调整。【F:doc/论文3_基于SysML模型的无人机飞控系统可靠性分析及全寿命周期费用优化.md†L632-L760】
