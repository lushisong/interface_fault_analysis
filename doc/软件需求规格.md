# 软件需求规格说明书

## 文档版本信息
| 版本号 | 编制日期 | 编制人 | 变更说明 |
| --- | --- | --- | --- |
| V1.0 | 2024-05-10 | 项目组 | 首次编制，覆盖核心业务、数据、界面需求 |

## 修订记录
| 序号 | 日期 | 修订人 | 修订内容 |
| --- | --- | --- | --- |
| 1 | 2024-05-10 | 项目组 | 新建文档 |

## 1. 引言
### 1.1 编写目的
本说明书用于完整描述接口失效分析平台的软件需求，明确系统必须满足的业务逻辑、数据结构、界面行为及约束条件，为后续的设计、开发、测试和运维提供统一依据。

### 1.2 项目背景
该平台面向复杂智能系统的接口故障建模与分析需求，为科研人员、系统工程师及测试人员提供接口建模、模块建模、系统结构构建、任务剖面分析、环境触发仿真和故障树分析等功能，以支撑可靠性评估与优化。

### 1.3 术语与缩略语
| 术语 | 说明 |
| --- | --- |
| 接口 | 系统内模块之间或系统与外部之间的信息交互点 |
| 失效模式 | 接口或模块在故障场景下的行为表现形式 |
| 状态机 | 描述接口状态及状态转移的有限状态机模型 |
| 任务剖面 | 任务执行过程中各阶段的定义、持续时间及成功判据 |
| FTA | Fault Tree Analysis，故障树分析 |
| 蒙特卡洛仿真 | 通过多次随机抽样模拟系统行为的统计分析方法 |

### 1.4 参考资料
- 软件设计说明书
- 相关国家标准《GB/T 8566-2010 信息技术 软件生存周期过程》
- 参考模型：Simulink、Modelica 等图形化建模工具

## 2. 项目概述
### 2.1 产品定位
接口失效分析平台用于构建智能系统的接口级模型，通过接口模板、模块模板及图形化系统装配，实现从单接口到系统级的失效分析闭环。

### 2.2 用户角色
| 角色 | 职责 | 目标 |
| --- | --- | --- |
| 系统工程师 | 搭建系统模型、配置模块与接口 | 快速构建系统结构并分析失效风险 |
| 可靠性分析师 | 定义故障场景、执行仿真与FTA | 获取接口及任务成功概率、关键路径 |
| 测试工程师 | 进行故障注入、验证模型 | 验证模型与实际测试数据的一致性 |
| 管理人员 | 管理模板、审阅报告 | 监督建模质量与分析结果 |

### 2.3 业务目标
1. 提供统一的接口建模工具，支持自定义代码与状态机配置。
2. 支持模块化复用，构建系统结构并进行任务剖面管理。
3. 集成环境与故障触发机制，实现蒙特卡洛仿真与故障树分析。
4. 为多角色提供友好界面与协作流程，保障数据一致性和可追溯性。

## 3. 总体描述
### 3.1 产品视角
系统作为独立的建模分析平台，通过 Web 界面与后端服务交互，提供模型管理、仿真执行及分析报告输出。系统与外部数据库、计算节点（用于仿真）以及文件存储服务进行数据交互。

### 3.2 功能摘要
- 接口建模：接口属性、状态机、Python 代码、失效模式定义。
- 模块建模：模块模板、接口关联、内部变量与行为脚本。
- 系统结构建模：图形化拖拽、连线、参数配置、拓扑管理。
- 任务剖面建模：多剖面管理、成功判据、阶段定义与结果保存。
- 环境与故障触发：环境模块、应力配置、故障注入、概率触发。
- 故障树分析：自动绘制、定性定量分析、敏感性分析、报告导出。

### 3.3 用户特点
用户具备工程背景，对建模工具和 Python 编程有一定掌握，期望系统提供高可视化、可追溯的建模体验。

### 3.4 假设与约束
- 系统运行在内网环境，具备 Python 运行和数据库支持。
- 建模脚本需符合平台提供的接口规范，禁止危险操作。
- 仿真任务可能占用大量计算资源，需支持异步执行与资源调度。

## 4. 系统功能需求
### 4.1 接口建模子系统
#### 4.1.1 功能概述
为各种接口构建模型，包括接口类型、行为脚本、状态机及失效模式。

#### 4.1.2 业务流程
1. 用户选择创建或编辑接口模板。
2. 填写基础属性（名称、方向、描述、所属模块类型等）。
3. 定义状态机：正常状态、多个故障状态、状态转移条件。
4. 编写 Python 行为脚本，描述数据处理与状态响应。
5. 配置触发条件、输入输出变量及依赖环境参数。
6. 保存并版本化接口模板，可用于模块实例化。

#### 4.1.3 功能需求列表
| 编号 | 需求描述 | 输入 | 输出 | 处理逻辑 |
| --- | --- | --- | --- | --- |
| IF-01 | 新建接口模板 | 表单数据 | 接口模板记录 | 校验必填项，保存至数据库 |
| IF-02 | 编辑接口模板 | 模板 ID、修改数据 | 更新后的记录 | 校验版本冲突，记录变更历史 |
| IF-03 | 状态机配置 | 状态/转移数据 | 状态机定义 | 校验状态唯一性及转移条件完整性 |
| IF-04 | 代码编辑 | Python 脚本 | 代码存档、语法校验结果 | 使用内置校验器进行语法检查与沙箱验证 |
| IF-05 | 模板发布 | 模板 ID | 可用模板列表 | 更新模板状态为“已发布” |

#### 4.1.4 异常处理
- 状态机循环/孤立状态提示用户修正。
- Python 脚本包含非法库或危险操作时阻止保存。
- 模板与实例绑定关系断开时提供警告并生成变更任务。

### 4.2 模块建模子系统
#### 4.2.1 功能概述
支持为硬件、软件、算法模块建立模型，关联接口模板并描述内部逻辑。

#### 4.2.2 业务流程
1. 用户选择模块类型（硬件/软件/算法）。
2. 指定模块名称、版本、功能描述。
3. 从接口库选择接口模板，关联至模块。
4. 配置模块内部变量映射与初始值。
5. 编辑模块行为 Python 脚本，描述内部逻辑。
6. 选择或自定义失效模式描述。
7. 保存并发布模块模板。

#### 4.2.3 功能需求列表
| 编号 | 需求描述 | 输入 | 输出 | 处理逻辑 |
| --- | --- | --- | --- | --- |
| MD-01 | 模块模板创建 | 基础信息、关联接口 | 模板记录 | 校验名称唯一、接口完整性 |
| MD-02 | 接口映射 | 模板 ID、接口列表 | 映射关系 | 校验接口兼容性、方向匹配 |
| MD-03 | 内部变量定义 | 变量配置 | 变量清单 | 支持标量/向量、数据类型校验 |
| MD-04 | 行为脚本编辑 | Python 脚本 | 脚本版本 | 语法校验、单元测试片段运行 |
| MD-05 | 模板实例化 | 模板 ID、实例参数 | 模块实例 | 生成实例记录并继承接口配置 |

#### 4.2.4 异常处理
- 接口方向不匹配时提示并阻止保存。
- 行为脚本运行失败记录日志并提示修改。
- 模板更新需通知引用的系统模型进行同步审核。

### 4.3 系统结构建模子系统
#### 4.3.1 功能概述
提供类似 Simulink 的图形化建模界面，通过模块实例、连线与参数配置构建系统拓扑。

#### 4.3.2 业务流程
1. 用户在画布上拖拽模块实例。
2. 配置模块实例参数（名称、版本、运行模式等）。
3. 通过接口连线建立模块间连接。
4. 配置连接属性（信号方向、传输介质）。
5. 保存系统模型并进行版本管理。
6. 触发模型校验，确保连线合法性与参数一致性。

#### 4.3.3 功能需求列表
| 编号 | 需求描述 | 输入 | 输出 | 处理逻辑 |
| --- | --- | --- | --- | --- |
| SM-01 | 画布管理 | 系统模型基础信息 | 新建画布 | 初始化画布资源 |
| SM-02 | 模块实例放置 | 模块模板、位置 | 模块节点 | 校验模板状态、生成实例 ID |
| SM-03 | 连线配置 | 起点接口、终点接口 | 连接关系 | 校验方向、数据类型、是否可重复连接 |
| SM-04 | 系统校验 | 模型 ID | 校验报告 | 执行连通性、闭环、延迟等规则校验 |
| SM-05 | 模型发布 | 模型 ID | 发布记录 | 锁定版本，生成快照 |

#### 4.3.4 异常处理
- 连线错误（方向或类型不匹配）高亮提示并禁止发布。
- 模块模板被撤销时提示重新选择版本。
- 系统校验失败提供详细报告及修复建议。

### 4.4 任务剖面建模子系统
#### 4.4.1 功能概述
定义任务执行阶段、持续时间、成功判据，并管理多个剖面供分析使用。

#### 4.4.2 业务流程
1. 创建任务剖面，填写基本信息。
2. 通过表格添加阶段，设定持续时间、关联模块输出及成功阈值。
3. 指定关键指标及监控参数。
4. 保存剖面并选择用于仿真或故障树分析。
5. 分析完成后将结果与剖面关联保存。

#### 4.4.3 功能需求列表
| 编号 | 需求描述 | 输入 | 输出 | 处理逻辑 |
| --- | --- | --- | --- | --- |
| TP-01 | 剖面管理 | 剖面信息 | 剖面记录 | 校验阶段时间、判据配置 |
| TP-02 | 阶段配置 | 阶段条目 | 阶段记录 | 校验持续时间、判据关联字段 |
| TP-03 | 判据关联 | 模块/接口输出 | 判据定义 | 校验数据类型与单位一致 |
| TP-04 | 结果保存 | 分析结果数据 | 历史记录 | 关联仿真任务 ID，支持版本回溯 |

#### 4.4.4 异常处理
- 判据引用不存在的模块输出时阻止保存并提示。
- 阶段持续时间不合法（≤0）时提示修正。
- 删除剖面需确认并检查关联分析任务。

### 4.5 环境与故障触发子系统
#### 4.5.1 功能概述
用于建模外部环境、配置故障注入和概率触发机制。

#### 4.5.2 业务流程
1. 拖拽环境模块至系统模型或单独配置环境场景。
2. 设置环境参数（温度、振动、压力等）及分布。
3. 定义环境应力作用对象及作用方式。
4. 配置直接故障注入或概率触发规则。
5. 运行蒙特卡洛仿真，生成任务成功概率数据。

#### 4.5.3 功能需求列表
| 编号 | 需求描述 | 输入 | 输出 | 处理逻辑 |
| --- | --- | --- | --- | --- |
| EN-01 | 环境模块配置 | 模块参数 | 环境配置记录 | 校验参数范围、单位 |
| EN-02 | 故障注入 | 对象标识、模式 | 注入任务 | 立即切换状态机至指定故障 |
| EN-03 | 概率触发 | 参数分布、目标接口 | 触发规则 | 构建概率模型并写入状态机条件 |
| EN-04 | 蒙特卡洛仿真 | 仿真配置 | 仿真结果 | 调度计算任务，统计成功率 |

#### 4.5.4 异常处理
- 参数分布不合法（负方差等）提示错误。
- 仿真失败需记录日志并允许重新提交。
- 多个环境模块作用同一接口时提供冲突检测。

### 4.6 故障树分析子系统
#### 4.6.1 功能概述
基于任务剖面自动生成故障树，并执行定性、定量分析。

#### 4.6.2 业务流程
1. 选择任务剖面和系统模型版本。
2. 自动提取关键事件并生成故障树结构。
3. 展示图形化故障树，支持节点编辑、标注。
4. 执行定性分析（最小割集、关键路径）。
5. 执行定量分析（节点概率、重要度、敏感性）。
6. 输出分析报告并保存历史记录。

#### 4.6.3 功能需求列表
| 编号 | 需求描述 | 输入 | 输出 | 处理逻辑 |
| --- | --- | --- | --- | --- |
| FT-01 | 故障树生成 | 剖面、模型 | 故障树结构 | 解析模型与剖面，构建事件节点 |
| FT-02 | 图形展示 | 故障树数据 | 图形界面 | 提供缩放、折叠、标注功能 |
| FT-03 | 定性分析 | 故障树 | 分析报告 | 计算最小割集、路径重要度 |
| FT-04 | 定量分析 | 仿真或历史数据 | 概率指标 | 计算节点概率、灵敏度 |
| FT-05 | 报告导出 | 分析结果 | PDF/HTML 报告 | 支持模板、公司 Logo 定制 |

#### 4.6.4 异常处理
- 故障树生成失败提供错误定位信息。
- 分析过程中数据缺失时提示补全并支持跳过节点。
- 报告导出失败时提供重试和日志查看。

### 4.7 公共服务需求
- 用户管理：角色权限、单点登录、操作日志。
- 模板库管理：版本控制、标签分类、检索。
- 通知与任务调度：仿真任务进度通知、消息中心。
- 数据导入导出：支持 JSON/CSV 导入导出模型和结果。

## 5. 数据需求
### 5.1 数据架构概览
系统采用关系型数据库管理核心数据，使用文档型存储保存脚本和分析报告，分层缓存提升读取性能。

### 5.2 核心实体
#### 5.2.1 接口模板（InterfaceTemplate）
| 字段 | 类型 | 约束 | 说明 |
| --- | --- | --- | --- |
| id | UUID | 主键 | 接口模板唯一标识 |
| name | varchar(128) | 唯一 | 接口名称 |
| direction | enum(in/out/bidirectional) | 非空 | 接口方向 |
| category | varchar(64) | 可空 | 接口分类标签 |
| state_machine | jsonb | 非空 | 状态机定义（状态、转移） |
| script_path | varchar(256) | 非空 | 行为脚本存储路径 |
| triggers | jsonb | 非空 | 触发条件列表 |
| version | int | 非空 | 版本号 |
| status | enum(draft/published/retired) | 非空 | 模板状态 |
| created_by | varchar(64) | 非空 | 创建人 |
| created_at | datetime | 非空 | 创建时间 |
| updated_at | datetime | 非空 | 更新时间 |

#### 5.2.2 模块模板（ModuleTemplate）
| 字段 | 类型 | 约束 | 说明 |
| --- | --- | --- | --- |
| id | UUID | 主键 | 模板标识 |
| name | varchar(128) | 唯一 | 模板名称 |
| module_type | enum(hardware/software/algorithm) | 非空 | 模块类型 |
| description | text | 可空 | 模板描述 |
| interfaces | jsonb | 非空 | 关联接口列表及映射信息 |
| variables | jsonb | 非空 | 内部变量定义 |
| behavior_script | varchar(256) | 非空 | 行为脚本路径 |
| failure_modes | jsonb | 可空 | 失效模式描述 |
| version | int | 非空 | 版本号 |
| status | enum(draft/published/retired) | 非空 | 状态 |
| created_at | datetime | 非空 | 创建时间 |
| updated_at | datetime | 非空 | 更新时间 |

#### 5.2.3 系统模型（SystemModel）
| 字段 | 类型 | 约束 | 说明 |
| --- | --- | --- | --- |
| id | UUID | 主键 | 系统模型标识 |
| name | varchar(128) | 唯一 | 模型名称 |
| topology | jsonb | 非空 | 拓扑结构（节点、连线） |
| parameters | jsonb | 可空 | 模块实例与连线参数 |
| version | int | 非空 | 版本号 |
| status | enum(draft/published/retired) | 非空 | 状态 |
| created_by | varchar(64) | 非空 | 创建人 |
| created_at | datetime | 非空 | 创建时间 |
| updated_at | datetime | 非空 | 更新时间 |

#### 5.2.4 任务剖面（TaskProfile）
| 字段 | 类型 | 约束 | 说明 |
| --- | --- | --- | --- |
| id | UUID | 主键 | 任务剖面标识 |
| name | varchar(128) | 唯一 | 剖面名称 |
| description | text | 可空 | 描述 |
| stages | jsonb | 非空 | 阶段列表（名称、持续时间、判据） |
| success_criteria | jsonb | 非空 | 成功判据集合 |
| related_model_id | UUID | 外键 | 关联系统模型 |
| version | int | 非空 | 版本号 |
| created_at | datetime | 非空 | 创建时间 |
| updated_at | datetime | 非空 | 更新时间 |

#### 5.2.5 环境场景（EnvironmentScenario）
| 字段 | 类型 | 约束 | 说明 |
| --- | --- | --- | --- |
| id | UUID | 主键 | 环境场景标识 |
| name | varchar(128) | 唯一 | 场景名称 |
| parameters | jsonb | 非空 | 环境参数配置 |
| stress_targets | jsonb | 非空 | 作用对象及方式 |
| probability_rules | jsonb | 可空 | 概率触发规则 |
| linked_profiles | jsonb | 可空 | 关联任务剖面列表 |
| created_at | datetime | 非空 | 创建时间 |
| updated_at | datetime | 非空 | 更新时间 |

#### 5.2.6 仿真任务（SimulationRun）
| 字段 | 类型 | 约束 | 说明 |
| --- | --- | --- | --- |
| id | UUID | 主键 | 仿真任务标识 |
| system_model_id | UUID | 外键 | 关联系统模型 |
| task_profile_id | UUID | 外键 | 关联任务剖面 |
| environment_id | UUID | 外键 | 关联环境场景 |
| configuration | jsonb | 非空 | 仿真配置参数 |
| status | enum(pending/running/success/failed) | 非空 | 运行状态 |
| result_summary | jsonb | 可空 | 统计结果 |
| logs_path | varchar(256) | 可空 | 日志路径 |
| created_at | datetime | 非空 | 创建时间 |
| completed_at | datetime | 可空 | 完成时间 |

#### 5.2.7 故障树记录（FaultTreeRecord）
| 字段 | 类型 | 约束 | 说明 |
| --- | --- | --- | --- |
| id | UUID | 主键 | 故障树记录标识 |
| system_model_id | UUID | 外键 | 系统模型 |
| task_profile_id | UUID | 外键 | 任务剖面 |
| structure | jsonb | 非空 | 故障树结构数据 |
| qualitative_results | jsonb | 可空 | 定性分析结果 |
| quantitative_results | jsonb | 可空 | 定量分析结果 |
| generated_by | varchar(64) | 非空 | 生成用户 |
| created_at | datetime | 非空 | 生成时间 |

### 5.3 数据完整性与约束
- 所有模板须具备唯一名称与版本组合。
- 状态机定义需通过 JSON Schema 校验。
- 脚本文件在对象存储中按版本归档，元数据记录在数据库。
- 删除操作采用软删除，保留历史记录以支持追溯。

### 5.4 数据访问与安全
- 通过角色权限控制访问接口及数据实体。
- 对敏感数据（如仿真日志）进行加密存储。
- 操作日志记录用户、时间、操作类型及影响对象。

## 6. 界面设计
### 6.1 总体界面架构
系统采用 Web SPA 架构，主界面分为导航区、工作区、属性面板、消息面板。各子系统通过统一的菜单入口访问，支持暗色/亮色主题切换。

### 6.2 登录与仪表盘
- 登录页：输入用户名、密码，支持单点登录与验证码。
- 仪表盘：展示最近模型、仿真任务状态、待办事项、通知列表，提供快捷入口。

### 6.3 接口建模界面
- 画布：显示接口属性卡片，左侧为模板列表，右侧为属性配置面板。
- 状态机编辑器：可视化状态节点与连线，支持拖拽、条件编辑、验证按钮。
- 代码编辑器：基于 Monaco Editor，提供语法高亮、自动补全、执行预览。
- 触发条件面板：配置环境参数、任务阶段与状态转移的关联规则。
- 版本面板：展示历史版本、差异对比、回滚按钮。

### 6.4 模块建模界面
- 模块属性区：配置模块基本信息、标签、所属项目。
- 接口列表区：以表格列出关联接口，显示方向、模板来源、状态。
- 变量面板：定义内部变量，支持导入 CSV。
- 行为脚本编辑区：与接口代码编辑器一致，支持调用接口 API。
- 模板库面板：右侧浮动面板展示可选模板及搜索过滤功能。

### 6.5 系统结构建模界面
- 主画布：支持模块拖拽、缩放、网格对齐、连线提示。
- 属性侧栏：显示选中模块或连线的属性，支持参数编辑和版本切换。
- 校验结果弹窗：展示校验通过/失败信息，失败项列表可定位到模块或连线。
- 模型导航：提供层次结构树和迷你地图，便于大型模型导航。
- 快捷工具：包含撤销、重做、对齐、布局优化、自动排布等。

### 6.6 任务剖面界面
- 剖面列表：以卡片或表格形式展示剖面概要，支持筛选。
- 阶段编辑表格：包含阶段名称、持续时间、关联输出、阈值、描述。
- 判据配置对话框：选择模块/接口输出，设置阈值和比较逻辑。
- 历史结果面板：展示关联仿真和故障树记录，支持下载报告。

### 6.7 环境与故障触发界面
- 环境模块库：按类别展示可选环境模板。
- 参数配置表单：针对不同环境模块提供动态表单和图表预览。
- 故障注入控制台：选择目标接口/模块、故障模式，支持批量操作。
- 概率触发配置：图形化展示参数分布，提供分布类型选择、参数输入、预览图。
- 仿真任务面板：显示运行状态、进度条、历史记录。

### 6.8 故障树分析界面
- 故障树画布：采用树形布局，支持节点折叠、悬浮提示、颜色编码。
- 事件详情面板：展示节点概率、重要度、关联接口信息。
- 分析工具栏：包含最小割集计算、灵敏度分析、报告生成按钮。
- 报告预览区：在线预览 PDF/HTML，支持注释和导出。

### 6.9 通用界面规范
- 所有表单提供实时校验、错误提示、帮助信息。
- 支持国际化，当前默认中文，可扩展英文界面。
- 提供快捷键支持（如 Ctrl+S 保存、Ctrl+Z 撤销）。
- 采用统一 UI 组件库，保障一致性与可用性。

## 7. 性能需求
- 支持 500 个以上接口模板、200 个模块模板的快速检索（<2 秒）。
- 图形化建模界面在 200 个节点、400 条连线下保持流畅（帧率 ≥ 30fps）。
- 蒙特卡洛仿真支持并行运行 1000 次迭代，平均响应时间控制在可配置阈值内。

## 8. 安全需求
- 强制 HTTPS 访问，数据传输加密。
- 用户密码加密存储，支持双因素认证。
- 关键操作（发布、删除）需二次确认与权限校验。
- 仿真脚本执行在沙箱内，限制系统调用与外部网络访问。

## 9. 可用性需求
- 提供上下文帮助与操作指南。
- 支持批量操作、撤销恢复、自动保存草稿。
- 系统可用性目标：全年 99.5% 运行时间。

## 10. 兼容性与集成需求
- 浏览器支持：Chrome、Edge、Firefox 最新稳定版本。
- 与 LDAP/AD 集成实现统一身份认证。
- 提供 RESTful API 供第三方系统获取模型与分析结果。

## 11. 可靠性与恢复
- 支持仿真任务失败自动重试 3 次。
- 实施数据库定期备份与跨机房备份策略。
- 提供灾备计划，最大数据丢失时间（RPO）≤ 10 分钟，最大恢复时间（RTO）≤ 1 小时。

## 12. 维护与运维需求
- 提供系统监控仪表盘，监控 CPU、内存、任务队列长度。
- 支持在线日志查看与下载。
- 支持灰度发布与版本回滚。
- 提供运维手册与故障处理流程。

## 13. 文档与培训
- 提供用户手册、开发者指南、API 文档。
- 定期组织培训，包含系统操作、建模最佳实践、案例分享。
- 支持知识库与 FAQ，方便用户自助查询。

## 14. 质量保证
- 所有需求需关联测试用例，覆盖单元测试、集成测试、系统测试。
- 需求变更需经过评审，并更新需求追踪矩阵。
- 建立持续集成流水线，自动执行代码检查与测试。

## 15. 附录
- A：界面原型链接（待补充）。
- B：脚本开发规范（参见开发者指南）。
- C：参考 API 列表（待补充）。
